#!/command/with-contenv bash
#shellcheck shell=bash

# If gain is specified...
if [[ -n "$DUMP978_SDR_GAIN" ]]; then

    # If the user wants to use the autogain system...
    if [[ "$DUMP978_SDR_GAIN" == "autogain" ]]; then

        set -eo pipefail

        # Run autogain
        #shellcheck disable=SC2016
        s6wrap --quiet --timestamps --prepend="$(basename "$0")" --args bash /scripts/autogain.sh
        # Sleep for 15 mins
        sleep "$AUTOGAIN_SERVICE_PERIOD"

    fi

else
    sleep infinity
fi
